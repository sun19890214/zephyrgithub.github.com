
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Sctict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>开放平台的微博经常出现重复的问题</title>
    <meta name="author" content="Kevin Sornberger"/>
    <link rel="stylesheet" href="/assets/themes/creatively/css/styles.css"/>
</head>

<body>
<div id="container">
    <div id="header">
        <div id="me">
            <a href="/" class="first-name">海贼的少年</a>
            <!--<a href="/" class="last-name">Bighi</a>-->
        </div>

        <div id="mousing">&nbsp;</div>
        <div class="site"></div>


        <div id="archive">
            <div><a href="/archive.html">存档</a></div>
            <div style="padding-bottom: 6px;"></div>
            <div><a href="/categories.html">分类</a></div>
            <div style="padding-bottom: 6px;"></div>
            <div><a href="/tags.html">Tag</a></div>
        </div>

        <div id="icons">
            <div class="side-rss">
                <a href="/atom.xml"><img src="/assets/themes/creatively/images/rss.png"></a>
            </div>

            <div class="side-github">
                <a href="http://www.github.com/zephyrGithub"><img src="/assets/themes/creatively/images/icon_github.png"/></a>
            </div>

            <div class="side-twitter">
                <a href="http://www.weibo.com/niubijian"><img src="/assets/themes/creatively/images/icon_weibo.png"/></a>
            </div>
        </div>

        <div id="sections">
            <div><a href="/about.html">About</a></div>
        </div>
    </div>

    <div id="body-header">
        <p></p>
    </div>

    
<div class="content">
  <div id="post">
    <h1>
        <a href="/2012/12/26/%E5%BC%80%E6%94%BE%E5%B9%B3%E5%8F%B0%E7%9A%84%E5%BE%AE%E5%8D%9A%E7%BB%8F%E5%B8%B8%E5%87%BA%E7%8E%B0%E9%87%8D%E5%A4%8D%E7%9A%84%E9%97%AE%E9%A2%98">开放平台的微博经常出现重复的问题</a>
    </h1>

    <div class="authoring">
        December 26, 2012
    </div>

    <p>今天发现不少用户从open api过来的微博有重复，终于找到了原因，猜测了一下导致微博重复的流程：</p>

<p>1、用户发一条微博</p>

<p>2、服务器处理这条微博，代码处理了发微博的逻辑之后抛了异常，后面代码未执行完，返回501</p>

<p>3、用户（应该是某个程序或者微博工具）发现服务器端返回非200，又发了一遍上条微博</p>

<p>造成重复微博的出现</p>

<p>类似错误半天多就产生了 2 573条</p>

<p>悲剧的是log打出来的e.getMessage() 为null，上面try块比较大，而且所调用的方法有许多是申明了抛异常的&#8230;</p>
  </div>




  





</div>
</body>
</html>

