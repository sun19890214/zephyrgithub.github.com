---
layout: post
title: "开放平台的微博经常出现重复的问题"
description: ""
category:
tags: 开放平台
---
{% include JB/setup %}



今天发现不少用户从open api过来的微博有重复，终于找到了原因，猜测了一下导致微博重复的流程：

1、用户发一条微博

2、服务器处理这条微博，代码处理了发微博的逻辑之后抛了异常，后面代码未执行完，返回501

3、用户（应该是某个程序或者微博工具）发现服务器端返回非200，又发了一遍上条微博

造成重复微博的出现

类似错误半天多就产生了 2 573条

悲剧的是log打出来的e.getMessage() 为null，上面try块比较大，而且所调用的方法有许多是申明了抛异常的...

